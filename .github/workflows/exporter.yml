name: Export

on: push

jobs:
  export:
    runs-on: windows-latest
    name: Export PsBuilder
    steps:
      - uses: actions/checkout@v2
      - run: cd .\
      - run: mv ".\PsBuilder.init.ps1" ".\PsBuilder.ps1"
      - run: Install-Module ps2exe -Force
        shell: powershell     
      - run: Invoke-ps2exe ".\PsBuilder.ps1" ".\PsBuilder.exe" -noConsole
        shell: powershell
      - uses: actions/upload-artifact@v2
        with:
          name: app
          path: .\PsBuilder.exe
      - uses: actions/upload-artifact@v2
        with:
          name: executable-pwsh-script
          path: .\PsBuilder.ps1
